<h1>Products</h1>

<%= form_tag discontinue_admin_products_path, method: :delete do %>
  <table>
    <thead>
      <tr>
        <th></th>
        <th>Product name</th>
        <th>Image</th>
        <th>Vendor code</th>
        <th>Price</th>
        <th>Description</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @products.each do |product| %>
        <tr>
          <td><%= check_box_tag "product_ids[]", product.id%></td>
          <td><%= product.product_name %></td>

          <% if product.image.attached? == false %>
            <td><%= image_tag("plh.png", class: "max_img_width") %></td>
          <% else %>
            <td><%= image_tag(product.image, class: "max_img_width")%></td>
          <% end %>

          <td><%= product.vendor_code %></td>
          <td><%= product.price %>$</td>

          <% if product.description.empty?%>
            <td><p>This product has no description</p></td>
          <% else %>
            <td><%= product.description %></td>
          <% end %>

          <% if current_user.admin? %>
            <td><%= link_to 'Show', admin_product_path(product) %></td>
            <td><%= link_to 'Edit', edit_admin_product_path(product) %></td>
            <td><%= link_to 'Destroy', admin_product_path(product), method: :delete, data: { confirm: 'Are you sure?' } %></td> 
          <% end %> 
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= submit_tag "Delete selected products", data: { confirm: 'Are you sure?' } %>
  <%= link_to 'Delete all', delete_all_admin_products_path, method: :get, data: { confirm: 'Are you sure?' } %>
<% end %>

<%= will_paginate @products, renderer: WillPaginate::ActionView::BootstrapLinkRenderer %>

<br>
<% if current_user.admin? %>
  <%= link_to 'New Product', new_admin_product_path %>
  <br>
  <%= link_to 'Back', root_path %>
<% end %>